<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blood Buddy - Online Blood Group Directory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .olive-gradient { background: linear-gradient(to right, #6b8e23, #556b2f); }
        .blue-gradient { background: linear-gradient(to right, #87ceeb, #5dade2); }
        .bg-gradient-custom { background: linear-gradient(to bottom, #f0f8ff, #f5fffa); }
        .border-olive { border-left-color: #6b8e23; }
        .text-yellow { color: #ffe135; }
    </style>
</head>
<body class="bg-gradient-custom min-h-screen">
    <div id="app"></div>

    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // SVG Icons (Search, Phone, Share, Heart, Users, Building2, MapPin, AlertCircle)
        // ... (same as your previous code) ...

        const BloodDonorApp = () => {
            const [donors, setDonors] = useState([]);
            const [filteredDonors, setFilteredDonors] = useState([]);
            const [loading, setLoading] = useState(true);
            const [selectedBloodGroup, setSelectedBloodGroup] = useState('');
            const [searchQuery, setSearchQuery] = useState('');
            const [activeTab, setActiveTab] = useState('search');
            const [showBeABuddy, setShowBeABuddy] = useState(false);
            const [currentPage, setCurrentPage] = useState(1);

            const donorsPerPage = 10;

            const bloodGroups = ['A +ve', 'A -ve', 'B +ve', 'B -ve', 'AB +ve', 'AB -ve', 'O +ve', 'O -ve'];
            const bloodBanks = [
                { name: 'Thrissur Govt Medical College Blood Bank', phone: '+914872421340', place: 'Thrissur' },
                { name: 'Caritas Hospital Blood Bank', phone: '+914842383333', place: 'Kottayam' },
                { name: 'Lakeshore Hospital Blood Bank', phone: '+914842701032', place: 'Kochi' },
                { name: 'IMA Blood Bank', phone: '+914872333518', place: 'Thrissur' },
                { name: 'Kerala Institute of Medical Sciences', phone: '+914713041400', place: 'Trivandrum' }
            ];

            useEffect(() => {
                fetch('donors.json')
                    .then(response => response.json())
                    .then(data => {
                        setDonors(data);
                        setFilteredDonors(data);
                        setLoading(false);
                    })
                    .catch(error => {
                        console.error('Error loading donors:', error);
                        setLoading(false);
                    });
            }, []);

            useEffect(() => {
                let filtered = [...donors];

                if (selectedBloodGroup) {
                    filtered = filtered.filter(d => d.bloodGroup === selectedBloodGroup);
                }

                if (searchQuery) {
                    const query = searchQuery.toLowerCase();
                    filtered = filtered.filter(d =>
                        d.name.toLowerCase().includes(query) ||
                        d.place.toLowerCase().includes(query) ||
                        d.number.includes(query)
                    );
                }

                setFilteredDonors(filtered);
                setCurrentPage(1); // Reset page on filter change
            }, [selectedBloodGroup, searchQuery, donors]);

            const indexOfLastDonor = currentPage * donorsPerPage;
            const indexOfFirstDonor = indexOfLastDonor - donorsPerPage;
            const currentDonors = filteredDonors.slice(indexOfFirstDonor, indexOfLastDonor);
            const totalPages = Math.ceil(filteredDonors.length / donorsPerPage);

            const handleCall = (number) => {
                window.location.href = `tel:${number}`;
            };

            const handleShare = (donor) => {
                const message = `Blood Donor Contact:\n\nName: ${donor.name}\nBlood Group: ${donor.bloodGroup}\nNumber: ${donor.number}\nPlace: ${donor.place}\n\nConnect via Blood Buddy App`;
                
                if (navigator.share) {
                    navigator.share({
                        title: 'Blood Donor Contact',
                        text: message
                    });
                } else {
                    const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
                    window.open(whatsappUrl, '_blank');
                }
            };

            // DonorCard, BeABuddyForm same as previous with no changes

            return (
                <div className="min-h-screen bg-gradient-custom">
                    {/* Header */}
                    <div className="text-white p-6 shadow-lg olive-gradient">
                        <div className="flex justify-center">
                            <div className="text-center">
                                <h1 className="text-4xl font-bold mb-1">Blood Buddy</h1>
                                <p className="text-sm text-yellow">Online Blood Group Directory</p>
                            </div>
                        </div>
                    </div>

                    {/* Tabs */}
                    <div className="flex bg-white shadow-md sticky top-0 z-40">
                        <button
                            onClick={() => setActiveTab('search')}
                            className="flex-1 py-4 font-semibold transition-colors"
                            style={{
                                color: activeTab === 'search' ? '#87ceeb' : '#666',
                                borderBottom: activeTab === 'search' ? '2px solid #87ceeb' : 'none'
                            }}
                        >
                            <Users className="inline mr-2" size={20} />
                            Find Donors
                        </button>
                        <button
                            onClick={() => setActiveTab('bloodbanks')}
                            className="flex-1 py-4 font-semibold transition-colors"
                            style={{
                                color: activeTab === 'bloodbanks' ? '#87ceeb' : '#666',
                                borderBottom: activeTab === 'bloodbanks' ? '2px solid #87ceeb' : 'none'
                            }}
                        >
                            <Building2 className="inline mr-2" size={20} />
                            Blood Banks
                        </button>
                    </div>

                    {/* Filters + Content */}
                    <div className="p-4 max-w-4xl mx-auto pb-20">
                        {activeTab === 'search' && (
                            <>
                                {/* Sticky Filters */}
                                <div className="sticky top-0 z-30 bg-white p-4 shadow-md mb-4">
                                    <select
                                        value={selectedBloodGroup}
                                        onChange={(e) => setSelectedBloodGroup(e.target.value)}
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 text-lg mb-2"
                                    >
                                        <option value="">All Blood Groups ({donors.length} donors)</option>
                                        {bloodGroups.map(bg => (
                                            <option key={bg} value={bg}>{bg}</option>
                                        ))}
                                    </select>

                                    <div className="relative">
                                        <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={20} />
                                        <input
                                            type="text"
                                            placeholder="Search by name, place, or number..."
                                            value={searchQuery}
                                            onChange={(e) => setSearchQuery(e.target.value)}
                                            className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300"
                                        />
                                    </div>
                                </div>

                                {/* Donor List */}
                                <div className="mb-4">
                                    <p className="text-gray-600 font-medium">
                                        {loading ? 'Loading...' : `${filteredDonors.length} donor${filteredDonors.length !== 1 ? 's' : ''} found`}
                                    </p>
                                </div>

                                <div className="mb-4">
                                    {loading ? (
                                        <div className="text-center py-8">
                                            <div className="animate-spin rounded-full h-12 w-12 border-b-2 mx-auto" style={{borderColor: '#6b8e23'}}></div>
                                        </div>
                                    ) : currentDonors.length === 0 ? (
                                        <div className="text-center py-8 text-gray-500">
                                            <AlertCircle className="mx-auto mb-3" size={48} />
                                            <p>No donors found matching your criteria</p>
                                        </div>
                                    ) : (
                                        currentDonors.map((donor, idx) => (
                                            <DonorCard key={idx} donor={donor} />
                                        ))
                                    )}
                                </div>

                                {/* Pagination */}
                                {totalPages > 1 && (
                                    <div className="flex justify-center gap-2 mt-4">
                                        <button 
                                            disabled={currentPage === 1}
                                            onClick={() => setCurrentPage(prev => prev - 1)}
                                            className="px-3 py-1 bg-gray-200 rounded disabled:opacity-50"
                                        >
                                            Previous
                                        </button>
                                        <span className="px-3 py-1">{currentPage} / {totalPages}</span>
                                        <button 
                                            disabled={currentPage === totalPages}
                                            onClick={() => setCurrentPage(prev => prev + 1)}
                                            className="px-3 py-1 bg-gray-200 rounded disabled:opacity-50"
                                        >
                                            Next
                                        </button>
                                    </div>
                                )}
                            </>
                        )}

                        {activeTab === 'bloodbanks' && (
                            <div className="mb-20">
                                {bloodBanks.map((bank, idx) => (
                                    <div key={idx} className="border-b last:border-b-0 py-4">
                                        <h3 className="font-bold text-gray-800 mb-2">{bank.name}</h3>
                                        <div className="flex items-center gap-2 text-sm text-gray-600 mb-2">
                                            <MapPin size={14} />
                                            <span>{bank.place}</span>
                                        </div>
                                        <button
                                            onClick={() => handleCall(bank.phone)}
                                            className="text-white py-2 px-4 rounded-lg flex items-center gap-2 transition-all hover:opacity-90"
                                            style={{backgroundColor: '#6b8e23'}}
                                        >
                                            <Phone size={18} />
                                            {bank.phone}
                                        </button>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>

                    {/* Be a Buddy Button */}
                    <button
                        onClick={() => setShowBeABuddy(true)}
                        className="fixed bottom-16 right-6 text-white px-6 py-4 rounded-full shadow-2xl flex items-center gap-2 font-bold transition-all hover:scale-105 z-50 blue-gradient"
                    >
                        <Heart size={24} fill="white" />
                        Be a Buddy
                    </button>

                    {showBeABuddy && <BeABuddyForm />}

                    {/* Fixed Footer */}
                    <footer className="fixed bottom-0 w-full text-center text-gray-500 text-sm py-2 bg-white border-t shadow-lg z-40">
                        Developed by Navas Abdulkader
                    </footer>
                </div>
            );
        };

        ReactDOM.render(<BloodDonorApp />, document.getElementById('app'));
    </script>
</body>
</html>
